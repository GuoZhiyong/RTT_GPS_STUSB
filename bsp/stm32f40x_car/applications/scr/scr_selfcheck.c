#include "scr.h"




const unsigned char res_welcome[]={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x0C,0x0D,0xFF,0xCC,0x00,0x3E,0x01,0xF0,0x30,0x03,0x3F,0xF8,0x00,0x00,
0x00,0x0C,0x0C,0x0D,0xFF,0xCC,0x00,0xFF,0x87,0xFC,0x30,0x03,0x3F,0xF8,0x00,0x00,0x00,0x0C,0x0C,0x0D,0x80,0x0C,0x01,0xC1,0xCE,0x0E,0x38,0x07,0x30,0x00,0x00,0x00,
0x00,0x06,0x1E,0x19,0x80,0x0C,0x01,0x80,0xCC,0x06,0x38,0x07,0x30,0x00,0x00,0x00,0x00,0x06,0x1E,0x19,0x80,0x0C,0x03,0x00,0x18,0x03,0x3C,0x0F,0x30,0x00,0x00,0x00,
0x00,0x06,0x1E,0x19,0x80,0x0C,0x03,0x00,0x18,0x03,0x3C,0x0F,0x30,0x00,0x00,0x00,0x00,0x03,0x33,0x31,0xFF,0x8C,0x03,0x00,0x18,0x03,0x36,0x1B,0x3F,0xF0,0x00,0x00,
0x00,0x03,0x33,0x31,0xFF,0x8C,0x03,0x00,0x18,0x03,0x36,0x1B,0x3F,0xF0,0x00,0x00,0x00,0x03,0x33,0x31,0x80,0x0C,0x03,0x00,0x18,0x03,0x33,0x33,0x30,0x00,0x00,0x00,
0x00,0x01,0xE1,0xE1,0x80,0x0C,0x03,0x00,0x18,0x03,0x33,0x33,0x30,0x00,0x00,0x00,0x00,0x01,0xE1,0xE1,0x80,0x0C,0x01,0x80,0xCC,0x06,0x31,0xE3,0x30,0x00,0x00,0x00,
0x00,0x01,0xE1,0xE1,0x80,0x0C,0x01,0xC1,0xCE,0x0E,0x31,0xE3,0x30,0x00,0x00,0x00,0x00,0x00,0xC0,0xC1,0xFF,0xCF,0xF8,0xFF,0x87,0xFC,0x30,0xC3,0x3F,0xF8,0x00,0x00,
0x00,0x00,0xC0,0xC1,0xFF,0xCF,0xF8,0x3E,0x01,0xF0,0x30,0xC3,0x3F,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

DECL_BMP(122,32,res_welcome);


static unsigned char percent=0;
static unsigned int	tick=0;

static void display(void)
{
	lcd_fill(0);
	lcd_text12(7,4,"设备自检,请稍候...",18,LCD_MODE_SET);
	/*绘制进度条*/
	lcd_rect(11,20,100,7,LCD_MODE_SET);
	lcd_fill_rect(11,20,11+percent,21+5,LCD_MODE_SET);
	lcd_update_all( );


}

static void show(void *parent)
{
	scr_selfcheck.parent=(PSCR)parent;
	display();
}




/*按键处理*/
static void keypress(unsigned int key)
{

}

/*系统时间*/
static void timetick(unsigned int systick)
{	
	if(percent<100)
	{
		percent+=5;
		display();
		tick=systick;
	}
	else
	{
		if((systick-tick)<10)
		{
			lcd_fill(0);
			lcd_bitmap(0,0,&BMP_res_welcome,LCD_MODE_SET);
			lcd_update_all();
		}	
		else if(systick-tick==100*2)
		{
			lcd_fill(0);
			lcd_fill_rect(0,12,121,24,LCD_MODE_SET);
			lcd_text12(16,12,"未设置车牌号码!",15,LCD_MODE_INVERT);
			lcd_update_all();
		}
		else if(systick-tick>100*4)
		{
			pscr=&scr_a_vehicle;
			pscr->show(&scr_selfcheck);
		}
		
	}

}

/*处理自检状态的消息*/
static void msg(void *p)
{


}



SCR scr_selfcheck=
{
	&show,
	&keypress,
	&timetick,
	(void*)0
};
